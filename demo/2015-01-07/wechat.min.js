!function(e,i){var n=function(){},t=function(){this.calls=[],this.map={events:{friend:"menu:share:appmessage",timeline:"menu:share:timeline",weibo:"menu:share:weibo",email:"email"},actions:{friend:"sendAppMessage",timeline:"shareTimeline",weibo:"shareWeibo",email:"email"},direct:{network:"getNetworkType",hideToolbar:"hideToolbar",hideOptionMenu:"hideOptionMenu",showOptionMenu:"showOptionMenu",closeWebView:"closeWindow",scanQRCode:"scanQRCode",imagePreview:"imagePreview"}}};t.prototype._data=function(e){var i={};for(var n in e){if(!e.hasOwnProperty(n))return;i[n]="function"==typeof e[n]?e[n]():e[n]}return i.appid=i.app,i.img_url=i.img,delete i.app,delete i.img,i},t.prototype._make=function(e){if("undefined"==typeof WeixinJSBridge)return this.calls.push(e);var i=e.name,n=this.map.direct[i],t=e.data,a=e.callback;if(n)return"network"===i?WeixinJSBridge.invoke(n,{},a):"imagePreview"===i?WeixinJSBridge.invoke(n,t,a):WeixinJSBridge.call(n,a);if("weibo"===i)t.content=t.desc,t.url=t.link;else if("timeline"===i)t.title=t.desc;else if("email"===i)return t.content=t.desc+" "+t.link,WeixinJSBridge.invoke("sendEmail",t,a);var o=this;WeixinJSBridge.on(this.map.events[i],function(){WeixinJSBridge.invoke(o.map.actions[i],t,a)})},t.prototype.on=function(e,i,t){return e?("function"==typeof i&&(t=i,i=null),this._make({name:e,data:i?this._data(i):{},callback:t||n}),this):void 0};var a=function(){for(var e=0,i=o.calls.length;i>e;e++)o._make(o.calls[e])},o=new t,r=function(){return o.on.apply(o,arguments)};"undefined"!=typeof exports&&module.exports?module.exports=exports=r:"function"==typeof define?define(function(e,i,n){n.exports=i=r}):e.wechat=e.wechat||r,"undefined"==typeof WeixinJSBridge?i.addEventListener?i.addEventListener("WeixinJSBridgeReady",a,!1):(i.attachEvent("WeixinJSBridgeReady",a),i.attachEvent("onWeixinJSBridgeReady",a)):a()}(window,document);